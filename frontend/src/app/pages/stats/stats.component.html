<div class="stats-wrap">
  <div class="grid">
    <!-- Overview -->
    <div class="card">
      <h2 class="card-title">Overview</h2>

      <div class="total-box">
        <div class="total-number">{{ totalWords }}</div>
        <div class="total-label">Total known words</div>
      </div>

      <h3 class="section-title">Words by language</h3>

      <ng-container *ngIf="!loading; else loadingTpl">
        <ng-container *ngIf="stats | keyvalue as entries; else noStatsTpl">
          <div class="lang-list" *ngIf="entries.length; else noStatsTpl">
            <div class="lang-row" *ngFor="let item of entries">
              <div class="lang-row-head">
                <span class="lang-title">
                  <span class="flag">{{ langFlag(item.key) }}</span>
                  <span>{{ langName(item.key) }}</span>
                </span>
                <span class="count">{{ item.value }}</span>
              </div>
              <div class="bar-bg">
                <div class="bar-fill" [style.width]="barWidth(item.value)"></div>
              </div>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>

    <!-- Recently added -->
    <div class="card">
      <h2 class="card-title">Recently added</h2>

      <ng-container *ngIf="!loading; else loadingTpl">
        <ng-container *ngIf="recentWords.length; else emptyRecentTpl">
          <div class="recent-list">
            <div class="recent-item" *ngFor="let w of recentWords; let i = index">
              <div class="left">
                <span class="emoji">{{ langFlag(w.lang) }}</span>
                <div class="text">
                  <div class="word">{{ w.text }}</div>
                  <div class="lang">{{ langName(w.lang) }}</div>
                </div>
              </div>
              <div class="time">
                {{ w.addedAt | date : 'MMM d, HH:mm' }}
              </div>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>

  <ng-template #loadingTpl>
    <div class="loading">Loading statsâ€¦</div>
  </ng-template>

  <ng-template #noStatsTpl>
    <p class="empty">
      No words learned yet. Start reading!
    </p>
  </ng-template>

  <ng-template #emptyRecentTpl>
    <div class="empty-block">
      <p class="title">No recent words</p>
      <p class="subtitle">
        Words you mark as known will appear here
      </p>
    </div>
  </ng-template>
</div>
